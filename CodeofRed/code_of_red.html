<html>
<head>
<title> MAIN_CODE_OF_RED</title>
</head>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://d3js.org/d3-color.v0.5.min.js"></script>
<script src="https://d3js.org/d3-hsv.v0.0.min.js"></script>
<script src="https://unpkg.com/react@15/dist/react.min.js"></script>
<script src="https://unpkg.com/react-dom@15/dist/react-dom.min.js"></script>
<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
<link rel="stylesheet" href="Styles/main.css">
<body>
<div id ="whole_page">
<div id="mainVisualization"></div>
<div id="writeup"></div>
</div>
<input type="range" name="year-selector" id="year-selector" value="2005" min="1900" max="2005" onchange="year_selector(this.value,i_ind)" ondrag="console.log(this.value)">	

<script src = "Data/Wars/America_War.js"></script>
<script src = "Data/Wars/Australia_War.js"></script>
<script src = "Data/Wars/Austria_War.js"></script>
<script src = "Data/Wars/Brazil_War.js"></script>
<script src = "Data/Wars/Britain_War.js"></script>

<script src = "Data/Art/America_Artwork.js"></script>
<script src = "Data/Art/Australia_Artwork.js"></script>
<script src = "Data/Art/Austria_Artwork.js"></script>
<script src = "Data/Art/Brazil_Artwork.js"></script>
<script src = "Data/Art/Britain_Artwork.js"></script>

<script src = "Scripts/circles.js"></script>	
<script src = "Scripts/writeup.js"></script>
<script>

// Background of the visualization
$('body').css('background-image','url(background.jpg)')
$('body').css('margin',4)

// Data 
var countries = ['America','Australia','Austria','Brazil','Britain'];
var wars = [America_War,Australia_War,Austria_War,Brazil_War,Britain_War];
var arts = [America_Artwork,Australia_Artwork,Austria_Artwork,Brazil_Artwork,Britain_Artwork];

// Initial Visualization Setup
var mainVisualizationCanvas = d3.select("#mainVisualization").append("svg")
     .attr("id","main")
     .attr("xmlns","http://www.w3.org/2000/svg")
     .attr("viewBox","0 0 500 500")
     .attr("class", "mainsvg");

var margin = 20
$('#mainVisualization').css("width",window.innerHeight-(2*margin));
$('#mainVisualization').css("height",window.innerHeight-(2*margin));
$('#mainVisualization').css("top",margin);
$('#mainVisualization').css("left",margin);
mainVisualizationCanvas.append("g")
								.attr("id","Year_Circles");
mainVisualizationCanvas.append("g")
								.attr("id","War_Fillers");
mainVisualizationCanvas.append("g")
								.attr("id","Art_Dots");

// Setting Initial Conditions
var i_ind = 4; // Choosing the first country data
year_selector(1970,i_ind);
year_selector(1970,i_ind);


function war_draw_data_generator (war_data) 
{

	var data = [];
	var count = 0;
	for ( var a = 1900 ; a <= 2016 ; a++)
	{
	data.push({"year":a,"wars":0}); 
	count = count+1;
	}

	var war_l = war_data.length;
	for ( var a = 0 ; a <war_l;a++)
	{
		var s_year = parseInt(war_data[a].start_year);
		var e_year = parseInt(war_data[a].end_year);
		for( var y = s_year ; y <=e_year ;y++)
		{
			var index = y - 1900 ;
			data[index].wars += 1;
		}
	}
	return data ;
}

function art_draw_data_generator (art_data)
{
	var nest_data = d3.nest()
						.key(function(d){ return d.artist_name})
						.key(function(d){ return d.year})
						.entries(art_data);
    return nest_data;
}


// Actual Drawing Functions
function year_selector(year,index) 
{
	$("#Art_Dots").remove();
	mainVisualizationCanvas.append("g")
						   .attr("id","Art_Dots");

	var current_country = countries[index];
	var current_war = wars[index];
	var current_art = arts[index];

	var current_drawing_data = war_draw_data_generator(current_war);
	var current_art_drawing_data = art_draw_data_generator(current_art);

	var start_year = parseInt(year);
	var end_year = start_year+10;
	main_visualization(start_year,end_year,current_drawing_data,current_art_drawing_data);
}


// To put the visualization in the center
// main_visualization(0,(window.innerWidth/2)-(window.innerHeight/2),1923,1933);


</script>

</body>
</html>